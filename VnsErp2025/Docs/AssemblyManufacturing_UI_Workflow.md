# Quy TrÃ¬nh Hoáº¡t Äá»™ng Module Assembly/Manufacturing - HÆ°á»›ng Dáº«n Thiáº¿t Káº¿ UI

## ğŸ“‹ Tá»•ng Quan

Module Assembly/Manufacturing há»— trá»£ quy trÃ¬nh:
1. **Quáº£n lÃ½ BOM (Bill of Materials)**: Äá»‹nh nghÄ©a cáº¥u trÃºc sáº£n pháº©m (1 sáº£n pháº©m hoÃ n chá»‰nh = nhiá»u linh kiá»‡n)
2. **Láº¯p rÃ¡p sáº£n pháº©m**: Tá»± Ä‘á»™ng xuáº¥t linh kiá»‡n vÃ  nháº­p sáº£n pháº©m hoÃ n chá»‰nh

---

## ğŸ”§ PHáº¦N 1: QUáº¢N LÃ BOM (Bill of Materials)

### 1.1. MÃ n HÃ¬nh Danh SÃ¡ch BOM

**Chá»©c nÄƒng:**
- Hiá»ƒn thá»‹ danh sÃ¡ch táº¥t cáº£ BOM Ä‘ang hoáº¡t Ä‘á»™ng
- TÃ¬m kiáº¿m, lá»c theo sáº£n pháº©m hoÃ n chá»‰nh
- Xem chi tiáº¿t BOM cá»§a tá»«ng sáº£n pháº©m

**UI Components:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  QUáº¢N LÃ BOM (BILL OF MATERIALS)                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [TÃ¬m kiáº¿m: ________] [Lá»c theo sáº£n pháº©m: â–¼] [ThÃªm má»›i]â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  GridView:                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ MÃ£ SP    â”‚ TÃªn Sáº£n Pháº©m     â”‚ Sá»‘ LK     â”‚ Thao tÃ¡c â”‚â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚
â”‚  â”‚ PC-001   â”‚ MÃ¡y tÃ­nh PC      â”‚ 5 linh kiá»‡nâ”‚ [Chi tiáº¿t]â”‚â”‚
â”‚  â”‚ LAP-001  â”‚ Laptop Dell      â”‚ 7 linh kiá»‡nâ”‚ [Chi tiáº¿t]â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Data Source:**
- `ProductBOMBll.GetAllActive()` - Láº¥y táº¥t cáº£ BOM Ä‘ang hoáº¡t Ä‘á»™ng
- Group by `ProductVariantId` Ä‘á»ƒ hiá»ƒn thá»‹ sá»‘ lÆ°á»£ng linh kiá»‡n

---

### 1.2. MÃ n HÃ¬nh Chi Tiáº¿t BOM (CRUD)

**Chá»©c nÄƒng:**
- Xem danh sÃ¡ch linh kiá»‡n cá»§a 1 sáº£n pháº©m
- ThÃªm/Sá»­a/XÃ³a linh kiá»‡n trong BOM
- Validate: Sáº£n pháº©m khÃ´ng thá»ƒ lÃ  linh kiá»‡n cá»§a chÃ­nh nÃ³

**UI Layout:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CHI TIáº¾T BOM - [TÃªn Sáº£n Pháº©m]                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ThÃ´ng tin sáº£n pháº©m:                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ MÃ£ SP: [PC-001        ] TÃªn: [MÃ¡y tÃ­nh PC      ] â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                        â”‚
â”‚  Danh sÃ¡ch linh kiá»‡n:                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”â”‚
â”‚  â”‚ STT  â”‚ TÃªn Linh Kiá»‡n     â”‚ Sá»‘ lÆ°á»£ng â”‚ ÄVT      â”‚  â”‚â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”¤â”‚
â”‚  â”‚  1   â”‚ CPU Intel i5     â”‚    1     â”‚ CÃ¡i      â”‚[X]â”‚â”‚
â”‚  â”‚  2   â”‚ RAM 8GB DDR4     â”‚    2     â”‚ Thanh    â”‚[X]â”‚â”‚
â”‚  â”‚  3   â”‚ á»” cá»©ng SSD 256GB â”‚    1     â”‚ CÃ¡i      â”‚[X]â”‚â”‚
â”‚  â”‚  4   â”‚ Mainboard H310   â”‚    1     â”‚ CÃ¡i      â”‚[X]â”‚â”‚
â”‚  â”‚  5   â”‚ Windows 10 Pro  â”‚    1     â”‚ License  â”‚[X]â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”˜â”‚
â”‚  [ThÃªm linh kiá»‡n] [LÆ°u] [Há»§y]                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Workflow:**
1. **Load dá»¯ liá»‡u:**
   - User chá»n sáº£n pháº©m tá»« danh sÃ¡ch â†’ Load BOM: `ProductBOMBll.GetByProductVariantId(productVariantId)`
   - Hiá»ƒn thá»‹ danh sÃ¡ch linh kiá»‡n trong grid

2. **ThÃªm linh kiá»‡n:**
   - Click "ThÃªm linh kiá»‡n" â†’ Má»Ÿ dialog chá»n linh kiá»‡n
   - User chá»n ProductVariant (linh kiá»‡n) tá»« dropdown
   - Nháº­p sá»‘ lÆ°á»£ng, chá»n Ä‘Æ¡n vá»‹ tÃ­nh
   - Validate: `ProductVariantId != ComponentVariantId`
   - Validate: `Quantity > 0`
   - Click "ThÃªm" â†’ ThÃªm vÃ o grid (chÆ°a lÆ°u DB)

3. **Sá»­a linh kiá»‡n:**
   - Click vÃ o dÃ²ng â†’ Enable edit mode
   - Sá»­a sá»‘ lÆ°á»£ng hoáº·c Ä‘Æ¡n vá»‹ tÃ­nh
   - Validate tÆ°Æ¡ng tá»±

4. **XÃ³a linh kiá»‡n:**
   - Click nÃºt [X] â†’ XÃ¡c nháº­n â†’ XÃ³a khá»i grid

5. **LÆ°u:**
   - Validate táº¥t cáº£ dÃ²ng trong grid
   - Loop qua tá»«ng dÃ²ng:
     - Náº¿u `Id == Guid.Empty` â†’ `ProductBOMBll.Create(bomDto)`
     - Náº¿u cÃ³ `Id` â†’ `ProductBOMBll.Update(bomDto)`
   - Náº¿u cÃ³ dÃ²ng bá»‹ xÃ³a â†’ `ProductBOMBll.Delete(id)`
   - Hiá»ƒn thá»‹ thÃ´ng bÃ¡o thÃ nh cÃ´ng

**Validation Rules:**
- Sáº£n pháº©m hoÃ n chá»‰nh: Required, khÃ´ng Ä‘Æ°á»£c trá»‘ng
- Linh kiá»‡n: Required, khÃ´ng Ä‘Æ°á»£c trá»‘ng
- Sáº£n pháº©m â‰  Linh kiá»‡n (khÃ´ng thá»ƒ tá»± láº¯p rÃ¡p chÃ­nh nÃ³)
- Sá»‘ lÆ°á»£ng: > 0
- ÄÆ¡n vá»‹ tÃ­nh: Required
- KhÃ´ng Ä‘Æ°á»£c trÃ¹ng linh kiá»‡n (1 sáº£n pháº©m chá»‰ cÃ³ 1 dÃ²ng cho má»—i linh kiá»‡n)

---

## ğŸ­ PHáº¦N 2: Láº®P RÃP Sáº¢N PHáº¨M

### 2.1. MÃ n HÃ¬nh Láº¯p RÃ¡p Sáº£n Pháº©m

**Chá»©c nÄƒng:**
- Chá»n sáº£n pháº©m cáº§n láº¯p rÃ¡p
- Nháº­p sá»‘ lÆ°á»£ng
- Xem danh sÃ¡ch linh kiá»‡n cáº§n thiáº¿t (tá»± Ä‘á»™ng load tá»« BOM)
- Kiá»ƒm tra tá»“n kho linh kiá»‡n
- TÃ­nh giÃ¡ thÃ nh tá»± Ä‘á»™ng
- Thá»±c hiá»‡n láº¯p rÃ¡p â†’ Tá»± Ä‘á»™ng táº¡o phiáº¿u xuáº¥t linh kiá»‡n + phiáº¿u nháº­p sáº£n pháº©m

**UI Layout:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Láº®P RÃP Sáº¢N PHáº¨M                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ThÃ´ng tin láº¯p rÃ¡p:                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Sáº£n pháº©m: [â–¼ MÃ¡y tÃ­nh PC (PC-001)          ]     â”‚ â”‚
â”‚  â”‚ Sá»‘ lÆ°á»£ng: [10        ] ÄVT: [Bá»™]                  â”‚ â”‚
â”‚  â”‚ Kho:      [â–¼ Kho chÃ­nh                    ]       â”‚ â”‚
â”‚  â”‚ NgÃ y:     [2025-01-15]                              â”‚ â”‚
â”‚  â”‚ Ghi chÃº:  [_____________________________]          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                        â”‚
â”‚  [Táº£i BOM] [Kiá»ƒm tra tá»“n kho] [TÃ­nh giÃ¡ thÃ nh]        â”‚
â”‚                                                        â”‚
â”‚  Danh sÃ¡ch linh kiá»‡n cáº§n thiáº¿t:                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”â”‚
â”‚  â”‚ STT  â”‚ TÃªn Linh Kiá»‡n     â”‚ SL   â”‚ Tá»“n  â”‚ Äá»§   â”‚ GiÃ¡â”‚â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤â”‚
â”‚  â”‚  1   â”‚ CPU Intel i5     â”‚  10  â”‚  15  â”‚ âœ“    â”‚ 5M â”‚â”‚
â”‚  â”‚  2   â”‚ RAM 8GB DDR4     â”‚  20  â”‚  25  â”‚ âœ“    â”‚ 4M â”‚â”‚
â”‚  â”‚  3   â”‚ á»” cá»©ng SSD 256GB â”‚  10  â”‚   8  â”‚ âœ—    â”‚ 3M â”‚â”‚
â”‚  â”‚  4   â”‚ Mainboard H310   â”‚  10  â”‚  12  â”‚ âœ“    â”‚ 2M â”‚â”‚
â”‚  â”‚  5   â”‚ Windows 10 Pro   â”‚  10  â”‚  10  â”‚ âœ“    â”‚ 1M â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜â”‚
â”‚                                                        â”‚
â”‚  Tá»•ng giÃ¡ thÃ nh: 15,000,000 VNÄ                       â”‚
â”‚  GiÃ¡ Ä‘Æ¡n vá»‹:     1,500,000 VNÄ/bá»™                     â”‚
â”‚                                                        â”‚
â”‚  [Thá»±c hiá»‡n láº¯p rÃ¡p] [Há»§y]                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Workflow Chi Tiáº¿t:**

#### BÆ°á»›c 1: Chá»n Sáº£n Pháº©m vÃ  Nháº­p ThÃ´ng Tin
1. User chá»n sáº£n pháº©m tá»« dropdown (chá»‰ hiá»ƒn thá»‹ sáº£n pháº©m cÃ³ BOM)
2. Nháº­p sá»‘ lÆ°á»£ng cáº§n láº¯p rÃ¡p
3. Chá»n kho thá»±c hiá»‡n láº¯p rÃ¡p
4. Chá»n ngÃ y láº¯p rÃ¡p (máº·c Ä‘á»‹nh = hÃ´m nay)
5. Nháº­p ghi chÃº (tÃ¹y chá»n)

#### BÆ°á»›c 2: Táº£i BOM (Tá»± Ä‘á»™ng hoáº·c Manual)
- **Tá»± Ä‘á»™ng:** Khi chá»n sáº£n pháº©m â†’ Tá»± Ä‘á»™ng load BOM
- **Manual:** Click "Táº£i BOM" â†’ `ProductBOMBll.GetByProductVariantId(productVariantId)`
- Hiá»ƒn thá»‹ danh sÃ¡ch linh kiá»‡n trong grid vá»›i:
  - TÃªn linh kiá»‡n
  - Sá»‘ lÆ°á»£ng cáº§n = `BOM.Quantity * Sá»‘ lÆ°á»£ng láº¯p rÃ¡p`
  - Tá»“n kho hiá»‡n táº¡i (load tá»« InventoryBalance)
  - Tráº¡ng thÃ¡i Ä‘á»§/thiáº¿u (mÃ u xanh/Ä‘á»)
  - ÄÆ¡n giÃ¡ linh kiá»‡n (tá»« InventoryBalance hoáº·c StockInOutDetail gáº§n nháº¥t)

#### BÆ°á»›c 3: Kiá»ƒm Tra Tá»“n Kho
- Click "Kiá»ƒm tra tá»“n kho" â†’ Validate:
  - `AssemblyBll.ValidateComponentAvailability()`
  - Kiá»ƒm tra tá»«ng linh kiá»‡n: `Tá»“n kho >= Sá»‘ lÆ°á»£ng cáº§n`
  - Náº¿u thiáº¿u â†’ Hiá»ƒn thá»‹ cáº£nh bÃ¡o chi tiáº¿t:
    ```
    âš ï¸ KhÃ´ng Ä‘á»§ linh kiá»‡n trong kho:
    - CPU Intel i5: Cáº§n 10, Tá»“n kho: 8
    - RAM 8GB DDR4: Cáº§n 20, Tá»“n kho: 15
    ```
  - Náº¿u Ä‘á»§ â†’ Hiá»ƒn thá»‹ "âœ“ Äá»§ linh kiá»‡n"

#### BÆ°á»›c 4: TÃ­nh GiÃ¡ ThÃ nh
- Click "TÃ­nh giÃ¡ thÃ nh" â†’ `AssemblyBll.CalculateAssemblyCost()`
- Hiá»ƒn thá»‹:
  - Tá»•ng giÃ¡ thÃ nh = Tá»•ng (Sá»‘ lÆ°á»£ng Ã— ÄÆ¡n giÃ¡) cá»§a táº¥t cáº£ linh kiá»‡n
  - GiÃ¡ Ä‘Æ¡n vá»‹ = Tá»•ng giÃ¡ thÃ nh / Sá»‘ lÆ°á»£ng láº¯p rÃ¡p
  - Chi tiáº¿t giÃ¡ tá»«ng linh kiá»‡n (cÃ³ thá»ƒ expand Ä‘á»ƒ xem)

#### BÆ°á»›c 5: Thá»±c Hiá»‡n Láº¯p RÃ¡p
- Click "Thá»±c hiá»‡n láº¯p rÃ¡p" â†’ Hiá»ƒn thá»‹ dialog xÃ¡c nháº­n:
  ```
  XÃ¡c nháº­n láº¯p rÃ¡p:
  - Sáº£n pháº©m: MÃ¡y tÃ­nh PC (PC-001)
  - Sá»‘ lÆ°á»£ng: 10 bá»™
  - Tá»•ng giÃ¡ thÃ nh: 15,000,000 VNÄ
  
  Há»‡ thá»‘ng sáº½ tá»± Ä‘á»™ng:
  âœ“ Táº¡o phiáº¿u xuáº¥t linh kiá»‡n (PXK-...)
  âœ“ Táº¡o phiáº¿u nháº­p sáº£n pháº©m (PNK-...)
  âœ“ Ghi nháº­n giao dá»‹ch láº¯p rÃ¡p
  
  [XÃ¡c nháº­n] [Há»§y]
  ```
- Click "XÃ¡c nháº­n" â†’ Gá»i `AssemblyBll.AssembleProductAsync(request)`
- **Quy trÃ¬nh tá»± Ä‘á»™ng:**
  1. Validate dá»¯ liá»‡u
  2. Load BOM tá»« ProductVariantId
  3. Validate Ä‘á»§ linh kiá»‡n trong kho
  4. TÃ­nh giÃ¡ thÃ nh
  5. **Trong 1 transaction:**
     - Táº¡o phiáº¿u xuáº¥t linh kiá»‡n (LoaiNhapXuatKhoEnum.XuatLinhKienLapRap)
     - Táº¡o phiáº¿u nháº­p sáº£n pháº©m (LoaiNhapXuatKhoEnum.NhapSanPhamLapRap)
     - LÆ°u AssemblyTransaction
  6. Commit transaction
- **Káº¿t quáº£:**
  - Hiá»ƒn thá»‹ thÃ´ng bÃ¡o thÃ nh cÃ´ng:
    ```
    âœ“ Láº¯p rÃ¡p thÃ nh cÃ´ng!
    - Phiáº¿u xuáº¥t: PXK-0115-16001
    - Phiáº¿u nháº­p: PNK-0115-06001
    - Sá»‘ lÆ°á»£ng: 10 bá»™
    - GiÃ¡ thÃ nh: 15,000,000 VNÄ
    ```
  - CÃ³ thá»ƒ má»Ÿ xem phiáº¿u xuáº¥t/nháº­p Ä‘Ã£ táº¡o

---

### 2.2. MÃ n HÃ¬nh Lá»‹ch Sá»­ Láº¯p RÃ¡p

**Chá»©c nÄƒng:**
- Xem danh sÃ¡ch cÃ¡c giao dá»‹ch láº¯p rÃ¡p Ä‘Ã£ thá»±c hiá»‡n
- Lá»c theo sáº£n pháº©m, kho, ngÃ y
- Xem chi tiáº¿t tá»«ng giao dá»‹ch
- Link Ä‘áº¿n phiáº¿u xuáº¥t/nháº­p liÃªn quan

**UI Layout:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Lá»ŠCH Sá»¬ Láº®P RÃP                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [TÃ¬m kiáº¿m] [Lá»c: Sáº£n pháº©m â–¼] [Kho â–¼] [Tá»« ngÃ y] [Äáº¿n] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  GridView:                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ NgÃ y     â”‚ Sáº£n pháº©m â”‚ SL   â”‚ GiÃ¡ thÃ nhâ”‚ Phiáº¿u      â”‚â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚
â”‚  â”‚ 15/01/25 â”‚ PC-001   â”‚ 10   â”‚ 15,000K  â”‚ [Chi tiáº¿t] â”‚â”‚
â”‚  â”‚ 14/01/25 â”‚ LAP-001  â”‚  5   â”‚ 12,000K  â”‚ [Chi tiáº¿t] â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Data Source:**
- `AssemblyTransactionRepository.GetByDateRange(fromDate, toDate)`
- `AssemblyTransactionRepository.GetByProductVariantId(productVariantId)`

---

## ğŸ”„ Luá»“ng Dá»¯ Liá»‡u Tá»•ng Quan

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   UI Layer  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              BLL Layer                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ ProductBOMBll    â”‚    â”‚ AssemblyBll      â”‚        â”‚
â”‚  â”‚ - Create/Update  â”‚    â”‚ - AssembleProductâ”‚        â”‚
â”‚  â”‚ - GetByProductId â”‚    â”‚ - CalculateCost   â”‚        â”‚
â”‚  â”‚ - Delete         â”‚    â”‚ - ValidateStock  â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                                      â”‚
       â–¼                                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ProductBOM       â”‚              â”‚ Assembly         â”‚
â”‚ Repository       â”‚              â”‚ Transaction      â”‚
â”‚                  â”‚              â”‚ Repository       â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                                 â”‚
       â–¼                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Database                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚ ProductBOM   â”‚  â”‚ Assembly         â”‚             â”‚
â”‚  â”‚              â”‚  â”‚ Transaction      â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚ StockInOut   â”‚  â”‚ InventoryBalance â”‚             â”‚
â”‚  â”‚ Master/Detailâ”‚  â”‚                  â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âœ… Validation & Business Rules

### BOM Management:
1. âœ… Sáº£n pháº©m hoÃ n chá»‰nh pháº£i tá»“n táº¡i trong ProductVariant
2. âœ… Linh kiá»‡n pháº£i tá»“n táº¡i trong ProductVariant
3. âœ… Sáº£n pháº©m â‰  Linh kiá»‡n (khÃ´ng tá»± láº¯p rÃ¡p chÃ­nh nÃ³)
4. âœ… Sá»‘ lÆ°á»£ng > 0
5. âœ… KhÃ´ng trÃ¹ng linh kiá»‡n (1 sáº£n pháº©m chá»‰ cÃ³ 1 dÃ²ng BOM cho má»—i linh kiá»‡n)
6. âœ… ÄÆ¡n vá»‹ tÃ­nh pháº£i tá»“n táº¡i

### Assembly Process:
1. âœ… Sáº£n pháº©m pháº£i cÃ³ BOM (Ã­t nháº¥t 1 linh kiá»‡n)
2. âœ… Táº¥t cáº£ linh kiá»‡n pháº£i Ä‘á»§ tá»“n kho
3. âœ… Sá»‘ lÆ°á»£ng láº¯p rÃ¡p > 0
4. âœ… Kho pháº£i tá»“n táº¡i vÃ  Ä‘ang hoáº¡t Ä‘á»™ng
5. âœ… NgÃ y láº¯p rÃ¡p khÃ´ng Ä‘Æ°á»£c lÃ  tÆ°Æ¡ng lai (hoáº·c cho phÃ©p náº¿u cáº§n)

---

## ğŸ“Š CÃ¡c TÃ­nh NÄƒng Bá»• Sung (Optional)

### 1. Preview TrÆ°á»›c Khi Láº¯p RÃ¡p
- Hiá»ƒn thá»‹ preview phiáº¿u xuáº¥t/nháº­p sáº½ Ä‘Æ°á»£c táº¡o
- Cho phÃ©p chá»‰nh sá»­a giÃ¡ linh kiá»‡n (náº¿u cáº§n)

### 2. Láº¯p RÃ¡p Theo LÃ´
- Chá»n nhiá»u sáº£n pháº©m cÃ¹ng lÃºc
- Tá»± Ä‘á»™ng tÃ­nh tá»•ng linh kiá»‡n cáº§n thiáº¿t
- Táº¡o 1 phiáº¿u xuáº¥t cho táº¥t cáº£ linh kiá»‡n

### 3. BÃ¡o CÃ¡o
- BÃ¡o cÃ¡o giÃ¡ thÃ nh láº¯p rÃ¡p theo thá»i gian
- BÃ¡o cÃ¡o sá»­ dá»¥ng linh kiá»‡n
- BÃ¡o cÃ¡o hiá»‡u quáº£ láº¯p rÃ¡p

### 4. Import/Export BOM
- Import BOM tá»« Excel
- Export BOM ra Excel Ä‘á»ƒ chá»‰nh sá»­a

---

## ğŸ¨ UI/UX Recommendations

1. **Color Coding:**
   - Äá»§ linh kiá»‡n: MÃ u xanh (âœ“)
   - Thiáº¿u linh kiá»‡n: MÃ u Ä‘á» (âœ—)
   - Äang xá»­ lÃ½: MÃ u vÃ ng

2. **Loading States:**
   - Hiá»ƒn thá»‹ progress bar khi Ä‘ang tÃ­nh toÃ¡n giÃ¡ thÃ nh
   - Hiá»ƒn thá»‹ "Äang láº¯p rÃ¡p..." khi Ä‘ang xá»­ lÃ½

3. **Error Handling:**
   - Hiá»ƒn thá»‹ lá»—i cá»¥ thá»ƒ, khÃ´ng chá»‰ "Lá»—i xáº£y ra"
   - Gá»£i Ã½ cÃ¡ch kháº¯c phá»¥c (vÃ­ dá»¥: "Vui lÃ²ng nháº­p thÃªm linh kiá»‡n vÃ o kho")

4. **Confirmation Dialogs:**
   - XÃ¡c nháº­n trÆ°á»›c khi xÃ³a BOM
   - XÃ¡c nháº­n trÆ°á»›c khi láº¯p rÃ¡p (hiá»ƒn thá»‹ thÃ´ng tin chi tiáº¿t)

---

## ğŸ“ Notes

- Táº¥t cáº£ cÃ¡c thao tÃ¡c láº¯p rÃ¡p Ä‘á»u Ä‘Æ°á»£c ghi nháº­n trong `AssemblyTransaction`
- Phiáº¿u xuáº¥t/nháº­p Ä‘Æ°á»£c táº¡o tá»± Ä‘á»™ng, khÃ´ng cáº§n user táº¡o thá»§ cÃ´ng
- GiÃ¡ thÃ nh Ä‘Æ°á»£c tÃ­nh tá»± Ä‘á»™ng tá»« giÃ¡ linh kiá»‡n trong kho
- Há»‡ thá»‘ng Ä‘áº£m báº£o tÃ­nh nháº¥t quÃ¡n dá»¯ liá»‡u báº±ng transaction

